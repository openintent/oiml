{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://oiml.dev/schemas/oiml.intent/0.1.0/schema.json",
  "title": "Open Intent Modeling Language (OIML) Intent Schema",
  "description": "Schema for OIML intent definitions",
  "type": "object",
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference URI"
    },
    "type": {
      "type": "string",
      "const": "oiml.intent",
      "description": "Document type identifier"
    },
    "version": {
      "type": "string",
      "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)$",
      "description": "OIML schema version"
    },
    "ai_context": {
      "type": "object",
      "properties": {
        "purpose": {
          "type": "string",
          "description": "Purpose or context for the AI agent"
        },
        "instructions": {
          "type": "string",
          "description": "Instructions for the AI agent (multiline string)"
        },
        "references": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "kind": {
                "type": "string",
                "enum": ["file", "mcp_tool"],
                "description": "Type of reference"
              },
              "path": {
                "type": "string",
                "description": "Path to the referenced resource"
              },
              "tool": {
                "type": "string",
                "description": "Tool name (required when kind is 'mcp_tool')"
              },
              "description": {
                "type": "string",
                "description": "Description of the referenced resource"
              }
            },
            "required": ["kind"],
            "additionalProperties": false
          },
          "description": "References to external resources"
        }
      },
      "additionalProperties": false
    },
    "provenance": {
      "type": "object",
      "properties": {
        "created_by": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": ["human", "agent", "system"],
              "default": "human"
            },
            "name": {
              "type": "string"
            },
            "id": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "created_at": {
          "anyOf": [
            {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"
            },
            {
              "type": "string",
              "format": "date-time"
            }
          ]
        },
        "source": {
          "type": "string"
        },
        "model": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "intents": {
      "type": "array",
      "items": {
        "anyOf": [
          {
            "type": "object",
            "properties": {
              "kind": {
                "type": "string",
                "const": "add_entity"
              },
              "scope": {
                "type": "string",
                "const": "data"
              },
              "entity": {
                "type": "string",
                "minLength": 1
              },
              "fields": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string",
                      "minLength": 1
                    },
                    "type": {
                      "type": "string",
                      "enum": [
                        "string",
                        "text",
                        "integer",
                        "bigint",
                        "float",
                        "decimal",
                        "boolean",
                        "datetime",
                        "date",
                        "time",
                        "uuid",
                        "json",
                        "enum",
                        "array",
                        "bytes"
                      ]
                    },
                    "required": {
                      "type": "boolean"
                    },
                    "unique": {
                      "type": "boolean"
                    },
                    "default": {},
                    "max_length": {
                      "type": "integer",
                      "exclusiveMinimum": 0
                    },
                    "array_type": {
                      "type": "string",
                      "enum": ["string", "text", "integer", "bigint", "float", "decimal", "boolean", "uuid"]
                    },
                    "enum_values": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    },
                    "api": {
                      "type": "object",
                      "properties": {
                        "include": {
                          "type": "boolean",
                          "description": "Whether to include this field in API endpoints"
                        },
                        "endpoints": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "description": "Specific endpoints to include this field in"
                        }
                      },
                      "required": ["include"],
                      "additionalProperties": false,
                      "description": "API endpoint configuration for this field"
                    },
                    "relation": {
                      "type": "object",
                      "properties": {
                        "target_entity": {
                          "type": "string",
                          "minLength": 1
                        },
                        "kind": {
                          "type": "string",
                          "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                        },
                        "foreign_key": {
                          "type": "object",
                          "properties": {
                            "local_field": {
                              "type": "string",
                              "minLength": 1
                            },
                            "target_field": {
                              "type": "string",
                              "minLength": 1
                            },
                            "constraint_name": {
                              "type": "string"
                            }
                          },
                          "required": ["local_field", "target_field"],
                          "additionalProperties": false
                        },
                        "attributes": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string",
                                "enum": [
                                  "indexed",
                                  "unique",
                                  "nullable",
                                  "optional",
                                  "default_now",
                                  "id",
                                  "primary",
                                  "auto_increment",
                                  "updated_at",
                                  "foreign_key"
                                ]
                              },
                              "args": {
                                "type": "object",
                                "additionalProperties": {}
                              }
                            },
                            "required": ["name"],
                            "additionalProperties": false
                          },
                          "default": []
                        },
                        "reverse": {
                          "type": "object",
                          "properties": {
                            "enabled": {
                              "type": "boolean",
                              "default": true
                            },
                            "field_name": {
                              "type": "string",
                              "minLength": 1
                            },
                            "kind": {
                              "type": "string",
                              "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                            },
                            "attributes": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "name": {
                                    "type": "string",
                                    "enum": [
                                      "indexed",
                                      "unique",
                                      "nullable",
                                      "optional",
                                      "default_now",
                                      "id",
                                      "primary",
                                      "auto_increment",
                                      "updated_at",
                                      "foreign_key"
                                    ]
                                  },
                                  "args": {
                                    "type": "object",
                                    "additionalProperties": {}
                                  }
                                },
                                "required": ["name"],
                                "additionalProperties": false
                              },
                              "default": []
                            }
                          },
                          "required": ["field_name"],
                          "additionalProperties": false
                        },
                        "emit_migration": {
                          "type": "boolean",
                          "default": true
                        }
                      },
                      "required": ["target_entity", "kind"],
                      "additionalProperties": false
                    }
                  },
                  "required": ["name", "type"],
                  "additionalProperties": false
                },
                "minItems": 1
              },
              "primary_key": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                }
              },
              "unique": {
                "type": "array",
                "items": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "minLength": 1
                  },
                  "minItems": 1
                }
              },
              "indexes": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string",
                      "minLength": 1
                    },
                    "fields": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "minLength": 1
                      },
                      "minItems": 1
                    },
                    "unique": {
                      "type": "boolean",
                      "default": false
                    },
                    "type": {
                      "type": "string",
                      "enum": ["btree", "hash", "gist", "gin"]
                    }
                  },
                  "required": ["name", "fields"],
                  "additionalProperties": false
                }
              }
            },
            "required": ["kind", "scope", "entity", "fields"],
            "additionalProperties": false
          },
          {
            "type": "object",
            "properties": {
              "kind": {
                "type": "string",
                "const": "remove_entity"
              },
              "scope": {
                "type": "string",
                "const": "data"
              },
              "entity": {
                "type": "string",
                "minLength": 1
              },
              "cascade": {
                "type": "boolean",
                "default": false
              }
            },
            "required": ["kind", "scope", "entity"],
            "additionalProperties": false
          },
          {
            "type": "object",
            "properties": {
              "kind": {
                "type": "string",
                "const": "rename_entity"
              },
              "scope": {
                "type": "string",
                "const": "data"
              },
              "from": {
                "type": "string",
                "minLength": 1
              },
              "to": {
                "type": "string",
                "minLength": 1
              }
            },
            "required": ["kind", "scope", "from", "to"],
            "additionalProperties": false
          },
          {
            "type": "object",
            "properties": {
              "kind": {
                "type": "string",
                "const": "add_field"
              },
              "scope": {
                "type": "string",
                "const": "data"
              },
              "entity": {
                "type": "string",
                "minLength": 1
              },
              "fields": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string",
                      "minLength": 1
                    },
                    "type": {
                      "type": "string",
                      "enum": [
                        "string",
                        "text",
                        "integer",
                        "bigint",
                        "float",
                        "decimal",
                        "boolean",
                        "datetime",
                        "date",
                        "time",
                        "uuid",
                        "json",
                        "enum",
                        "array",
                        "bytes"
                      ]
                    },
                    "required": {
                      "type": "boolean"
                    },
                    "unique": {
                      "type": "boolean"
                    },
                    "default": {},
                    "max_length": {
                      "type": "integer",
                      "exclusiveMinimum": 0
                    },
                    "array_type": {
                      "type": "string",
                      "enum": ["string", "text", "integer", "bigint", "float", "decimal", "boolean", "uuid"]
                    },
                    "enum_values": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    },
                    "api": {
                      "type": "object",
                      "properties": {
                        "include": {
                          "type": "boolean",
                          "description": "Whether to include this field in API endpoints"
                        },
                        "endpoints": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "description": "Specific endpoints to include this field in"
                        }
                      },
                      "required": ["include"],
                      "additionalProperties": false,
                      "description": "API endpoint configuration for this field"
                    },
                    "relation": {
                      "type": "object",
                      "properties": {
                        "target_entity": {
                          "type": "string",
                          "minLength": 1
                        },
                        "kind": {
                          "type": "string",
                          "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                        },
                        "foreign_key": {
                          "type": "object",
                          "properties": {
                            "local_field": {
                              "type": "string",
                              "minLength": 1
                            },
                            "target_field": {
                              "type": "string",
                              "minLength": 1
                            },
                            "constraint_name": {
                              "type": "string"
                            }
                          },
                          "required": ["local_field", "target_field"],
                          "additionalProperties": false
                        },
                        "attributes": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string",
                                "enum": [
                                  "indexed",
                                  "unique",
                                  "nullable",
                                  "optional",
                                  "default_now",
                                  "id",
                                  "primary",
                                  "auto_increment",
                                  "updated_at",
                                  "foreign_key"
                                ]
                              },
                              "args": {
                                "type": "object",
                                "additionalProperties": {}
                              }
                            },
                            "required": ["name"],
                            "additionalProperties": false
                          },
                          "default": []
                        },
                        "reverse": {
                          "type": "object",
                          "properties": {
                            "enabled": {
                              "type": "boolean",
                              "default": true
                            },
                            "field_name": {
                              "type": "string",
                              "minLength": 1
                            },
                            "kind": {
                              "type": "string",
                              "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                            },
                            "attributes": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "name": {
                                    "type": "string",
                                    "enum": [
                                      "indexed",
                                      "unique",
                                      "nullable",
                                      "optional",
                                      "default_now",
                                      "id",
                                      "primary",
                                      "auto_increment",
                                      "updated_at",
                                      "foreign_key"
                                    ]
                                  },
                                  "args": {
                                    "type": "object",
                                    "additionalProperties": {}
                                  }
                                },
                                "required": ["name"],
                                "additionalProperties": false
                              },
                              "default": []
                            }
                          },
                          "required": ["field_name"],
                          "additionalProperties": false
                        },
                        "emit_migration": {
                          "type": "boolean",
                          "default": true
                        }
                      },
                      "required": ["target_entity", "kind"],
                      "additionalProperties": false
                    }
                  },
                  "required": ["name", "type"],
                  "additionalProperties": false
                },
                "minItems": 1
              }
            },
            "required": ["kind", "scope", "entity", "fields"],
            "additionalProperties": false
          },
          {
            "type": "object",
            "properties": {
              "kind": {
                "type": "string",
                "const": "remove_field"
              },
              "scope": {
                "type": "string",
                "const": "data"
              },
              "entity": {
                "type": "string",
                "minLength": 1
              },
              "fields": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "minItems": 1,
                "description": "Array of field names to remove from the entity"
              }
            },
            "required": ["kind", "scope", "entity", "fields"],
            "additionalProperties": false
          },
          {
            "type": "object",
            "properties": {
              "kind": {
                "type": "string",
                "const": "rename_field"
              },
              "scope": {
                "type": "string",
                "const": "data"
              },
              "entity": {
                "type": "string",
                "minLength": 1
              },
              "from": {
                "type": "string",
                "minLength": 1
              },
              "to": {
                "type": "string",
                "minLength": 1
              }
            },
            "required": ["kind", "scope", "entity", "from", "to"],
            "additionalProperties": false
          },
          {
            "type": "object",
            "properties": {
              "kind": {
                "type": "string",
                "const": "add_endpoint"
              },
              "scope": {
                "type": "string",
                "const": "api"
              },
              "method": {
                "type": "string",
                "enum": ["GET", "POST", "PUT", "PATCH", "DELETE"]
              },
              "path": {
                "type": "string",
                "pattern": "^\\/"
              },
              "description": {
                "type": "string"
              },
              "entity": {
                "type": "string"
              },
              "fields": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string",
                      "minLength": 1
                    },
                    "type": {
                      "type": "string",
                      "enum": [
                        "string",
                        "text",
                        "integer",
                        "bigint",
                        "float",
                        "decimal",
                        "boolean",
                        "datetime",
                        "date",
                        "time",
                        "uuid",
                        "json",
                        "enum",
                        "array",
                        "bytes"
                      ]
                    },
                    "required": {
                      "type": "boolean"
                    },
                    "unique": {
                      "type": "boolean"
                    },
                    "default": {},
                    "max_length": {
                      "type": "integer",
                      "exclusiveMinimum": 0
                    },
                    "array_type": {
                      "type": "string",
                      "enum": ["string", "text", "integer", "bigint", "float", "decimal", "boolean", "uuid"]
                    },
                    "enum_values": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    },
                    "api": {
                      "type": "object",
                      "properties": {
                        "include": {
                          "type": "boolean",
                          "description": "Whether to include this field in API endpoints"
                        },
                        "endpoints": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "description": "Specific endpoints to include this field in"
                        }
                      },
                      "required": ["include"],
                      "additionalProperties": false,
                      "description": "API endpoint configuration for this field"
                    },
                    "relation": {
                      "type": "object",
                      "properties": {
                        "target_entity": {
                          "type": "string",
                          "minLength": 1
                        },
                        "kind": {
                          "type": "string",
                          "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                        },
                        "foreign_key": {
                          "type": "object",
                          "properties": {
                            "local_field": {
                              "type": "string",
                              "minLength": 1
                            },
                            "target_field": {
                              "type": "string",
                              "minLength": 1
                            },
                            "constraint_name": {
                              "type": "string"
                            }
                          },
                          "required": ["local_field", "target_field"],
                          "additionalProperties": false
                        },
                        "attributes": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string",
                                "enum": [
                                  "indexed",
                                  "unique",
                                  "nullable",
                                  "optional",
                                  "default_now",
                                  "id",
                                  "primary",
                                  "auto_increment",
                                  "updated_at",
                                  "foreign_key"
                                ]
                              },
                              "args": {
                                "type": "object",
                                "additionalProperties": {}
                              }
                            },
                            "required": ["name"],
                            "additionalProperties": false
                          },
                          "default": []
                        },
                        "reverse": {
                          "type": "object",
                          "properties": {
                            "enabled": {
                              "type": "boolean",
                              "default": true
                            },
                            "field_name": {
                              "type": "string",
                              "minLength": 1
                            },
                            "kind": {
                              "type": "string",
                              "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                            },
                            "attributes": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "name": {
                                    "type": "string",
                                    "enum": [
                                      "indexed",
                                      "unique",
                                      "nullable",
                                      "optional",
                                      "default_now",
                                      "id",
                                      "primary",
                                      "auto_increment",
                                      "updated_at",
                                      "foreign_key"
                                    ]
                                  },
                                  "args": {
                                    "type": "object",
                                    "additionalProperties": {}
                                  }
                                },
                                "required": ["name"],
                                "additionalProperties": false
                              },
                              "default": []
                            }
                          },
                          "required": ["field_name"],
                          "additionalProperties": false
                        },
                        "emit_migration": {
                          "type": "boolean",
                          "default": true
                        }
                      },
                      "required": ["target_entity", "kind"],
                      "additionalProperties": false
                    }
                  },
                  "required": ["name", "type"],
                  "additionalProperties": false
                }
              },
              "auth": {
                "type": "object",
                "properties": {
                  "required": {
                    "type": "boolean",
                    "default": false
                  },
                  "roles": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                },
                "additionalProperties": false
              }
            },
            "required": ["kind", "scope", "method", "path"],
            "additionalProperties": false
          },
          {
            "type": "object",
            "properties": {
              "kind": {
                "type": "string",
                "const": "add_component"
              },
              "scope": {
                "type": "string",
                "const": "ui"
              },
              "component": {
                "type": "string",
                "minLength": 1
              },
              "template": {
                "type": "string",
                "enum": ["List", "Form", "Custom"],
                "default": "Custom"
              },
              "entity": {
                "type": "string"
              },
              "display_fields": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "route": {
                "type": "string"
              }
            },
            "required": ["kind", "scope", "component"],
            "additionalProperties": false
          },
          {
            "type": "object",
            "properties": {
              "kind": {
                "type": "string",
                "const": "add_relation"
              },
              "scope": {
                "type": "string",
                "const": "data"
              },
              "relation": {
                "type": "object",
                "properties": {
                  "source_entity": {
                    "type": "string",
                    "minLength": 1
                  },
                  "target_entity": {
                    "type": "string",
                    "minLength": 1
                  },
                  "kind": {
                    "type": "string",
                    "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                  },
                  "field_name": {
                    "type": "string",
                    "minLength": 1
                  },
                  "foreign_key": {
                    "type": "object",
                    "properties": {
                      "local_field": {
                        "type": "string",
                        "minLength": 1
                      },
                      "target_field": {
                        "type": "string",
                        "minLength": 1
                      },
                      "constraint_name": {
                        "type": "string"
                      }
                    },
                    "required": ["local_field", "target_field"],
                    "additionalProperties": false
                  },
                  "attributes": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string",
                          "enum": [
                            "indexed",
                            "unique",
                            "nullable",
                            "optional",
                            "default_now",
                            "id",
                            "primary",
                            "auto_increment",
                            "updated_at",
                            "foreign_key"
                          ]
                        },
                        "args": {
                          "type": "object",
                          "additionalProperties": {}
                        }
                      },
                      "required": ["name"],
                      "additionalProperties": false
                    },
                    "default": []
                  },
                  "reverse": {
                    "type": "object",
                    "properties": {
                      "enabled": {
                        "type": "boolean",
                        "default": true
                      },
                      "field_name": {
                        "type": "string",
                        "minLength": 1
                      },
                      "kind": {
                        "type": "string",
                        "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                      },
                      "attributes": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "name": {
                              "type": "string",
                              "enum": [
                                "indexed",
                                "unique",
                                "nullable",
                                "optional",
                                "default_now",
                                "id",
                                "primary",
                                "auto_increment",
                                "updated_at",
                                "foreign_key"
                              ]
                            },
                            "args": {
                              "type": "object",
                              "additionalProperties": {}
                            }
                          },
                          "required": ["name"],
                          "additionalProperties": false
                        },
                        "default": []
                      }
                    },
                    "required": ["field_name"],
                    "additionalProperties": false
                  },
                  "emit_migration": {
                    "type": "boolean",
                    "default": true
                  }
                },
                "required": ["source_entity", "target_entity", "kind", "field_name"],
                "additionalProperties": false
              }
            },
            "required": ["kind", "scope", "relation"],
            "additionalProperties": false
          },
          {
            "type": "object",
            "properties": {
              "kind": {
                "type": "string",
                "const": "update_endpoint"
              },
              "scope": {
                "type": "string",
                "const": "api"
              },
              "method": {
                "type": "string",
                "enum": ["GET", "POST", "PUT", "PATCH", "DELETE"]
              },
              "path": {
                "type": "string",
                "pattern": "^\\/"
              },
              "description": {
                "type": "string"
              },
              "updates": {
                "type": "object",
                "properties": {
                  "add_field": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string",
                          "minLength": 1,
                          "description": "Name of the field in the response"
                        },
                        "source": {
                          "type": "object",
                          "properties": {
                            "type": {
                              "type": "string",
                              "enum": ["relation", "field", "computed"],
                              "description": "Type of field source"
                            },
                            "relation": {
                              "type": "string",
                              "minLength": 1,
                              "description": "Relation name (required when type is 'relation')"
                            },
                            "entity": {
                              "type": "string",
                              "minLength": 1,
                              "description": "Entity name (required when type is 'field' or when selecting a field from a relation)"
                            },
                            "field": {
                              "type": "string",
                              "minLength": 1,
                              "description": "Field name to select (when type is 'field' or when selecting a specific field from a relation)"
                            },
                            "join": {
                              "type": "object",
                              "properties": {
                                "foreign_key": {
                                  "type": "string",
                                  "minLength": 1,
                                  "description": "Foreign key field name to join on"
                                },
                                "target_entity": {
                                  "type": "string",
                                  "minLength": 1,
                                  "description": "Target entity to join with"
                                },
                                "target_field": {
                                  "type": "string",
                                  "minLength": 1,
                                  "description": "Target field to select from joined entity"
                                }
                              },
                              "required": ["foreign_key", "target_entity", "target_field"],
                              "additionalProperties": false,
                              "description": "Join configuration for foreign key relationships"
                            }
                          },
                          "required": ["type"],
                          "additionalProperties": false,
                          "description": "Source configuration for the field"
                        }
                      },
                      "required": ["name", "source"],
                      "additionalProperties": false
                    },
                    "description": "Fields to add to the endpoint response (relations, specific fields, or computed values)"
                  }
                },
                "additionalProperties": false,
                "description": "Object specifying what to update in the endpoint"
              }
            },
            "required": ["kind", "scope", "method", "path", "updates"],
            "additionalProperties": false
          },
          {
            "type": "object",
            "properties": {
              "kind": {
                "type": "string",
                "const": "add_capability"
              },
              "scope": {
                "type": "string",
                "const": "capability"
              },
              "capability": {
                "type": "string",
                "enum": ["auth", "email", "storage", "file_stream", "sse", "websocket"],
                "description": "Type of capability to add"
              },
              "framework": {
                "type": "string",
                "minLength": 1,
                "description": "Target framework (e.g., 'gin', 'next', 'express')"
              },
              "provider": {
                "type": "string",
                "minLength": 1,
                "description": "Provider/library name (e.g., 'jwt', 'next-auth', 'passport')"
              },
              "config": {
                "type": "object",
                "additionalProperties": {},
                "description": "Capability-specific configuration options"
              },
              "endpoints": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "method": {
                      "type": "string",
                      "enum": ["GET", "POST", "PUT", "PATCH", "DELETE"]
                    },
                    "path": {
                      "type": "string",
                      "pattern": "^\\/"
                    },
                    "description": {
                      "type": "string"
                    },
                    "group": {
                      "type": "string",
                      "description": "Route group name (supports wildcard '*' to match all endpoints in a group, e.g., '/api/v1/*')"
                    }
                  },
                  "additionalProperties": false
                },
                "description": "Additional endpoints to create for this capability"
              }
            },
            "required": ["kind", "scope", "capability", "framework"],
            "additionalProperties": false
          }
        ]
      },
      "minItems": 1
    }
  },
  "required": ["type", "version", "intents"],
  "additionalProperties": false,
  "definitions": {
    "FieldType": {
      "type": "string",
      "enum": [
        "string",
        "text",
        "integer",
        "bigint",
        "float",
        "decimal",
        "boolean",
        "datetime",
        "date",
        "time",
        "uuid",
        "json",
        "enum",
        "array",
        "bytes"
      ]
    },
    "FieldAttribute": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "enum": [
            "indexed",
            "unique",
            "nullable",
            "optional",
            "default_now",
            "id",
            "primary",
            "auto_increment",
            "updated_at",
            "foreign_key"
          ]
        },
        "args": {
          "type": "object",
          "additionalProperties": {}
        }
      },
      "required": ["name"],
      "additionalProperties": false
    },
    "ForeignKey": {
      "type": "object",
      "properties": {
        "local_field": {
          "type": "string",
          "minLength": 1
        },
        "target_field": {
          "type": "string",
          "minLength": 1
        },
        "constraint_name": {
          "type": "string"
        }
      },
      "required": ["local_field", "target_field"],
      "additionalProperties": false
    },
    "RelationKind": {
      "type": "string",
      "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
    },
    "ReverseRelation": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true
        },
        "field_name": {
          "type": "string",
          "minLength": 1
        },
        "kind": {
          "type": "string",
          "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
        },
        "attributes": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "enum": [
                  "indexed",
                  "unique",
                  "nullable",
                  "optional",
                  "default_now",
                  "id",
                  "primary",
                  "auto_increment",
                  "updated_at",
                  "foreign_key"
                ]
              },
              "args": {
                "type": "object",
                "additionalProperties": {}
              }
            },
            "required": ["name"],
            "additionalProperties": false
          },
          "default": []
        }
      },
      "required": ["field_name"],
      "additionalProperties": false
    },
    "FieldRelation": {
      "type": "object",
      "properties": {
        "target_entity": {
          "type": "string",
          "minLength": 1
        },
        "kind": {
          "type": "string",
          "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
        },
        "foreign_key": {
          "type": "object",
          "properties": {
            "local_field": {
              "type": "string",
              "minLength": 1
            },
            "target_field": {
              "type": "string",
              "minLength": 1
            },
            "constraint_name": {
              "type": "string"
            }
          },
          "required": ["local_field", "target_field"],
          "additionalProperties": false
        },
        "attributes": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "enum": [
                  "indexed",
                  "unique",
                  "nullable",
                  "optional",
                  "default_now",
                  "id",
                  "primary",
                  "auto_increment",
                  "updated_at",
                  "foreign_key"
                ]
              },
              "args": {
                "type": "object",
                "additionalProperties": {}
              }
            },
            "required": ["name"],
            "additionalProperties": false
          },
          "default": []
        },
        "reverse": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true
            },
            "field_name": {
              "type": "string",
              "minLength": 1
            },
            "kind": {
              "type": "string",
              "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
            },
            "attributes": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "enum": [
                      "indexed",
                      "unique",
                      "nullable",
                      "optional",
                      "default_now",
                      "id",
                      "primary",
                      "auto_increment",
                      "updated_at",
                      "foreign_key"
                    ]
                  },
                  "args": {
                    "type": "object",
                    "additionalProperties": {}
                  }
                },
                "required": ["name"],
                "additionalProperties": false
              },
              "default": []
            }
          },
          "required": ["field_name"],
          "additionalProperties": false
        },
        "emit_migration": {
          "type": "boolean",
          "default": true
        }
      },
      "required": ["target_entity", "kind"],
      "additionalProperties": false
    },
    "Field": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "type": {
          "type": "string",
          "enum": [
            "string",
            "text",
            "integer",
            "bigint",
            "float",
            "decimal",
            "boolean",
            "datetime",
            "date",
            "time",
            "uuid",
            "json",
            "enum",
            "array",
            "bytes"
          ]
        },
        "required": {
          "type": "boolean"
        },
        "unique": {
          "type": "boolean"
        },
        "default": {},
        "max_length": {
          "type": "integer",
          "exclusiveMinimum": 0
        },
        "array_type": {
          "type": "string",
          "enum": ["string", "text", "integer", "bigint", "float", "decimal", "boolean", "uuid"]
        },
        "enum_values": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "api": {
          "type": "object",
          "properties": {
            "include": {
              "type": "boolean",
              "description": "Whether to include this field in API endpoints"
            },
            "endpoints": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Specific endpoints to include this field in"
            }
          },
          "required": ["include"],
          "additionalProperties": false,
          "description": "API endpoint configuration for this field"
        },
        "relation": {
          "type": "object",
          "properties": {
            "target_entity": {
              "type": "string",
              "minLength": 1
            },
            "kind": {
              "type": "string",
              "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
            },
            "foreign_key": {
              "type": "object",
              "properties": {
                "local_field": {
                  "type": "string",
                  "minLength": 1
                },
                "target_field": {
                  "type": "string",
                  "minLength": 1
                },
                "constraint_name": {
                  "type": "string"
                }
              },
              "required": ["local_field", "target_field"],
              "additionalProperties": false
            },
            "attributes": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "enum": [
                      "indexed",
                      "unique",
                      "nullable",
                      "optional",
                      "default_now",
                      "id",
                      "primary",
                      "auto_increment",
                      "updated_at",
                      "foreign_key"
                    ]
                  },
                  "args": {
                    "type": "object",
                    "additionalProperties": {}
                  }
                },
                "required": ["name"],
                "additionalProperties": false
              },
              "default": []
            },
            "reverse": {
              "type": "object",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "default": true
                },
                "field_name": {
                  "type": "string",
                  "minLength": 1
                },
                "kind": {
                  "type": "string",
                  "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                },
                "attributes": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string",
                        "enum": [
                          "indexed",
                          "unique",
                          "nullable",
                          "optional",
                          "default_now",
                          "id",
                          "primary",
                          "auto_increment",
                          "updated_at",
                          "foreign_key"
                        ]
                      },
                      "args": {
                        "type": "object",
                        "additionalProperties": {}
                      }
                    },
                    "required": ["name"],
                    "additionalProperties": false
                  },
                  "default": []
                }
              },
              "required": ["field_name"],
              "additionalProperties": false
            },
            "emit_migration": {
              "type": "boolean",
              "default": true
            }
          },
          "required": ["target_entity", "kind"],
          "additionalProperties": false
        }
      },
      "required": ["name", "type"],
      "additionalProperties": false
    },
    "Provenance": {
      "type": "object",
      "properties": {
        "created_by": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": ["human", "agent", "system"],
              "default": "human"
            },
            "name": {
              "type": "string"
            },
            "id": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "created_at": {
          "anyOf": [
            {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"
            },
            {
              "type": "string",
              "format": "date-time"
            }
          ]
        },
        "source": {
          "type": "string"
        },
        "model": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "AIContext": {
      "type": "object",
      "properties": {
        "purpose": {
          "type": "string",
          "description": "Purpose or context for the AI agent"
        },
        "instructions": {
          "type": "string",
          "description": "Instructions for the AI agent (multiline string)"
        },
        "references": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "kind": {
                "type": "string",
                "enum": ["file", "mcp_tool"],
                "description": "Type of reference"
              },
              "path": {
                "type": "string",
                "description": "Path to the referenced resource"
              },
              "tool": {
                "type": "string",
                "description": "Tool name (required when kind is 'mcp_tool')"
              },
              "description": {
                "type": "string",
                "description": "Description of the referenced resource"
              }
            },
            "required": ["kind"],
            "additionalProperties": false
          },
          "description": "References to external resources"
        }
      },
      "additionalProperties": false
    },
    "AddEntity": {
      "type": "object",
      "properties": {
        "kind": {
          "type": "string",
          "const": "add_entity"
        },
        "scope": {
          "type": "string",
          "const": "data"
        },
        "entity": {
          "type": "string",
          "minLength": 1
        },
        "fields": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "type": {
                "type": "string",
                "enum": [
                  "string",
                  "text",
                  "integer",
                  "bigint",
                  "float",
                  "decimal",
                  "boolean",
                  "datetime",
                  "date",
                  "time",
                  "uuid",
                  "json",
                  "enum",
                  "array",
                  "bytes"
                ]
              },
              "required": {
                "type": "boolean"
              },
              "unique": {
                "type": "boolean"
              },
              "default": {},
              "max_length": {
                "type": "integer",
                "exclusiveMinimum": 0
              },
              "array_type": {
                "type": "string",
                "enum": ["string", "text", "integer", "bigint", "float", "decimal", "boolean", "uuid"]
              },
              "enum_values": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "api": {
                "type": "object",
                "properties": {
                  "include": {
                    "type": "boolean",
                    "description": "Whether to include this field in API endpoints"
                  },
                  "endpoints": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Specific endpoints to include this field in"
                  }
                },
                "required": ["include"],
                "additionalProperties": false,
                "description": "API endpoint configuration for this field"
              },
              "relation": {
                "type": "object",
                "properties": {
                  "target_entity": {
                    "type": "string",
                    "minLength": 1
                  },
                  "kind": {
                    "type": "string",
                    "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                  },
                  "foreign_key": {
                    "type": "object",
                    "properties": {
                      "local_field": {
                        "type": "string",
                        "minLength": 1
                      },
                      "target_field": {
                        "type": "string",
                        "minLength": 1
                      },
                      "constraint_name": {
                        "type": "string"
                      }
                    },
                    "required": ["local_field", "target_field"],
                    "additionalProperties": false
                  },
                  "attributes": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string",
                          "enum": [
                            "indexed",
                            "unique",
                            "nullable",
                            "optional",
                            "default_now",
                            "id",
                            "primary",
                            "auto_increment",
                            "updated_at",
                            "foreign_key"
                          ]
                        },
                        "args": {
                          "type": "object",
                          "additionalProperties": {}
                        }
                      },
                      "required": ["name"],
                      "additionalProperties": false
                    },
                    "default": []
                  },
                  "reverse": {
                    "type": "object",
                    "properties": {
                      "enabled": {
                        "type": "boolean",
                        "default": true
                      },
                      "field_name": {
                        "type": "string",
                        "minLength": 1
                      },
                      "kind": {
                        "type": "string",
                        "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                      },
                      "attributes": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "name": {
                              "type": "string",
                              "enum": [
                                "indexed",
                                "unique",
                                "nullable",
                                "optional",
                                "default_now",
                                "id",
                                "primary",
                                "auto_increment",
                                "updated_at",
                                "foreign_key"
                              ]
                            },
                            "args": {
                              "type": "object",
                              "additionalProperties": {}
                            }
                          },
                          "required": ["name"],
                          "additionalProperties": false
                        },
                        "default": []
                      }
                    },
                    "required": ["field_name"],
                    "additionalProperties": false
                  },
                  "emit_migration": {
                    "type": "boolean",
                    "default": true
                  }
                },
                "required": ["target_entity", "kind"],
                "additionalProperties": false
              }
            },
            "required": ["name", "type"],
            "additionalProperties": false
          },
          "minItems": 1
        },
        "primary_key": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          }
        },
        "unique": {
          "type": "array",
          "items": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            },
            "minItems": 1
          }
        },
        "indexes": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "fields": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "minItems": 1
              },
              "unique": {
                "type": "boolean",
                "default": false
              },
              "type": {
                "type": "string",
                "enum": ["btree", "hash", "gist", "gin"]
              }
            },
            "required": ["name", "fields"],
            "additionalProperties": false
          }
        }
      },
      "required": ["kind", "scope", "entity", "fields"],
      "additionalProperties": false
    },
    "AddField": {
      "type": "object",
      "properties": {
        "kind": {
          "type": "string",
          "const": "add_field"
        },
        "scope": {
          "type": "string",
          "const": "data"
        },
        "entity": {
          "type": "string",
          "minLength": 1
        },
        "fields": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "type": {
                "type": "string",
                "enum": [
                  "string",
                  "text",
                  "integer",
                  "bigint",
                  "float",
                  "decimal",
                  "boolean",
                  "datetime",
                  "date",
                  "time",
                  "uuid",
                  "json",
                  "enum",
                  "array",
                  "bytes"
                ]
              },
              "required": {
                "type": "boolean"
              },
              "unique": {
                "type": "boolean"
              },
              "default": {},
              "max_length": {
                "type": "integer",
                "exclusiveMinimum": 0
              },
              "array_type": {
                "type": "string",
                "enum": ["string", "text", "integer", "bigint", "float", "decimal", "boolean", "uuid"]
              },
              "enum_values": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "api": {
                "type": "object",
                "properties": {
                  "include": {
                    "type": "boolean",
                    "description": "Whether to include this field in API endpoints"
                  },
                  "endpoints": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Specific endpoints to include this field in"
                  }
                },
                "required": ["include"],
                "additionalProperties": false,
                "description": "API endpoint configuration for this field"
              },
              "relation": {
                "type": "object",
                "properties": {
                  "target_entity": {
                    "type": "string",
                    "minLength": 1
                  },
                  "kind": {
                    "type": "string",
                    "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                  },
                  "foreign_key": {
                    "type": "object",
                    "properties": {
                      "local_field": {
                        "type": "string",
                        "minLength": 1
                      },
                      "target_field": {
                        "type": "string",
                        "minLength": 1
                      },
                      "constraint_name": {
                        "type": "string"
                      }
                    },
                    "required": ["local_field", "target_field"],
                    "additionalProperties": false
                  },
                  "attributes": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string",
                          "enum": [
                            "indexed",
                            "unique",
                            "nullable",
                            "optional",
                            "default_now",
                            "id",
                            "primary",
                            "auto_increment",
                            "updated_at",
                            "foreign_key"
                          ]
                        },
                        "args": {
                          "type": "object",
                          "additionalProperties": {}
                        }
                      },
                      "required": ["name"],
                      "additionalProperties": false
                    },
                    "default": []
                  },
                  "reverse": {
                    "type": "object",
                    "properties": {
                      "enabled": {
                        "type": "boolean",
                        "default": true
                      },
                      "field_name": {
                        "type": "string",
                        "minLength": 1
                      },
                      "kind": {
                        "type": "string",
                        "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                      },
                      "attributes": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "name": {
                              "type": "string",
                              "enum": [
                                "indexed",
                                "unique",
                                "nullable",
                                "optional",
                                "default_now",
                                "id",
                                "primary",
                                "auto_increment",
                                "updated_at",
                                "foreign_key"
                              ]
                            },
                            "args": {
                              "type": "object",
                              "additionalProperties": {}
                            }
                          },
                          "required": ["name"],
                          "additionalProperties": false
                        },
                        "default": []
                      }
                    },
                    "required": ["field_name"],
                    "additionalProperties": false
                  },
                  "emit_migration": {
                    "type": "boolean",
                    "default": true
                  }
                },
                "required": ["target_entity", "kind"],
                "additionalProperties": false
              }
            },
            "required": ["name", "type"],
            "additionalProperties": false
          },
          "minItems": 1
        }
      },
      "required": ["kind", "scope", "entity", "fields"],
      "additionalProperties": false
    },
    "RemoveField": {
      "type": "object",
      "properties": {
        "kind": {
          "type": "string",
          "const": "remove_field"
        },
        "scope": {
          "type": "string",
          "const": "data"
        },
        "entity": {
          "type": "string",
          "minLength": 1
        },
        "fields": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "description": "Array of field names to remove from the entity"
        }
      },
      "required": ["kind", "scope", "entity", "fields"],
      "additionalProperties": false
    },
    "AddEndpoint": {
      "type": "object",
      "properties": {
        "kind": {
          "type": "string",
          "const": "add_endpoint"
        },
        "scope": {
          "type": "string",
          "const": "api"
        },
        "method": {
          "type": "string",
          "enum": ["GET", "POST", "PUT", "PATCH", "DELETE"]
        },
        "path": {
          "type": "string",
          "pattern": "^\\/"
        },
        "description": {
          "type": "string"
        },
        "entity": {
          "type": "string"
        },
        "fields": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "type": {
                "type": "string",
                "enum": [
                  "string",
                  "text",
                  "integer",
                  "bigint",
                  "float",
                  "decimal",
                  "boolean",
                  "datetime",
                  "date",
                  "time",
                  "uuid",
                  "json",
                  "enum",
                  "array",
                  "bytes"
                ]
              },
              "required": {
                "type": "boolean"
              },
              "unique": {
                "type": "boolean"
              },
              "default": {},
              "max_length": {
                "type": "integer",
                "exclusiveMinimum": 0
              },
              "array_type": {
                "type": "string",
                "enum": ["string", "text", "integer", "bigint", "float", "decimal", "boolean", "uuid"]
              },
              "enum_values": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "api": {
                "type": "object",
                "properties": {
                  "include": {
                    "type": "boolean",
                    "description": "Whether to include this field in API endpoints"
                  },
                  "endpoints": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Specific endpoints to include this field in"
                  }
                },
                "required": ["include"],
                "additionalProperties": false,
                "description": "API endpoint configuration for this field"
              },
              "relation": {
                "type": "object",
                "properties": {
                  "target_entity": {
                    "type": "string",
                    "minLength": 1
                  },
                  "kind": {
                    "type": "string",
                    "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                  },
                  "foreign_key": {
                    "type": "object",
                    "properties": {
                      "local_field": {
                        "type": "string",
                        "minLength": 1
                      },
                      "target_field": {
                        "type": "string",
                        "minLength": 1
                      },
                      "constraint_name": {
                        "type": "string"
                      }
                    },
                    "required": ["local_field", "target_field"],
                    "additionalProperties": false
                  },
                  "attributes": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string",
                          "enum": [
                            "indexed",
                            "unique",
                            "nullable",
                            "optional",
                            "default_now",
                            "id",
                            "primary",
                            "auto_increment",
                            "updated_at",
                            "foreign_key"
                          ]
                        },
                        "args": {
                          "type": "object",
                          "additionalProperties": {}
                        }
                      },
                      "required": ["name"],
                      "additionalProperties": false
                    },
                    "default": []
                  },
                  "reverse": {
                    "type": "object",
                    "properties": {
                      "enabled": {
                        "type": "boolean",
                        "default": true
                      },
                      "field_name": {
                        "type": "string",
                        "minLength": 1
                      },
                      "kind": {
                        "type": "string",
                        "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                      },
                      "attributes": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "name": {
                              "type": "string",
                              "enum": [
                                "indexed",
                                "unique",
                                "nullable",
                                "optional",
                                "default_now",
                                "id",
                                "primary",
                                "auto_increment",
                                "updated_at",
                                "foreign_key"
                              ]
                            },
                            "args": {
                              "type": "object",
                              "additionalProperties": {}
                            }
                          },
                          "required": ["name"],
                          "additionalProperties": false
                        },
                        "default": []
                      }
                    },
                    "required": ["field_name"],
                    "additionalProperties": false
                  },
                  "emit_migration": {
                    "type": "boolean",
                    "default": true
                  }
                },
                "required": ["target_entity", "kind"],
                "additionalProperties": false
              }
            },
            "required": ["name", "type"],
            "additionalProperties": false
          }
        },
        "auth": {
          "type": "object",
          "properties": {
            "required": {
              "type": "boolean",
              "default": false
            },
            "roles": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "additionalProperties": false
        }
      },
      "required": ["kind", "scope", "method", "path"],
      "additionalProperties": false
    },
    "AddComponent": {
      "type": "object",
      "properties": {
        "kind": {
          "type": "string",
          "const": "add_component"
        },
        "scope": {
          "type": "string",
          "const": "ui"
        },
        "component": {
          "type": "string",
          "minLength": 1
        },
        "template": {
          "type": "string",
          "enum": ["List", "Form", "Custom"],
          "default": "Custom"
        },
        "entity": {
          "type": "string"
        },
        "display_fields": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "route": {
          "type": "string"
        }
      },
      "required": ["kind", "scope", "component"],
      "additionalProperties": false
    },
    "AddRelation": {
      "type": "object",
      "properties": {
        "kind": {
          "type": "string",
          "const": "add_relation"
        },
        "scope": {
          "type": "string",
          "const": "data"
        },
        "relation": {
          "type": "object",
          "properties": {
            "source_entity": {
              "type": "string",
              "minLength": 1
            },
            "target_entity": {
              "type": "string",
              "minLength": 1
            },
            "kind": {
              "type": "string",
              "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
            },
            "field_name": {
              "type": "string",
              "minLength": 1
            },
            "foreign_key": {
              "type": "object",
              "properties": {
                "local_field": {
                  "type": "string",
                  "minLength": 1
                },
                "target_field": {
                  "type": "string",
                  "minLength": 1
                },
                "constraint_name": {
                  "type": "string"
                }
              },
              "required": ["local_field", "target_field"],
              "additionalProperties": false
            },
            "attributes": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "enum": [
                      "indexed",
                      "unique",
                      "nullable",
                      "optional",
                      "default_now",
                      "id",
                      "primary",
                      "auto_increment",
                      "updated_at",
                      "foreign_key"
                    ]
                  },
                  "args": {
                    "type": "object",
                    "additionalProperties": {}
                  }
                },
                "required": ["name"],
                "additionalProperties": false
              },
              "default": []
            },
            "reverse": {
              "type": "object",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "default": true
                },
                "field_name": {
                  "type": "string",
                  "minLength": 1
                },
                "kind": {
                  "type": "string",
                  "enum": ["one_to_one", "one_to_many", "many_to_one", "many_to_many"]
                },
                "attributes": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string",
                        "enum": [
                          "indexed",
                          "unique",
                          "nullable",
                          "optional",
                          "default_now",
                          "id",
                          "primary",
                          "auto_increment",
                          "updated_at",
                          "foreign_key"
                        ]
                      },
                      "args": {
                        "type": "object",
                        "additionalProperties": {}
                      }
                    },
                    "required": ["name"],
                    "additionalProperties": false
                  },
                  "default": []
                }
              },
              "required": ["field_name"],
              "additionalProperties": false
            },
            "emit_migration": {
              "type": "boolean",
              "default": true
            }
          },
          "required": ["source_entity", "target_entity", "kind", "field_name"],
          "additionalProperties": false
        }
      },
      "required": ["kind", "scope", "relation"],
      "additionalProperties": false
    },
    "AddCapability": {
      "type": "object",
      "properties": {
        "kind": {
          "type": "string",
          "const": "add_capability"
        },
        "scope": {
          "type": "string",
          "const": "capability"
        },
        "capability": {
          "type": "string",
          "enum": ["auth", "email", "storage", "file_stream", "sse", "websocket"],
          "description": "Type of capability to add"
        },
        "framework": {
          "type": "string",
          "minLength": 1,
          "description": "Target framework (e.g., 'gin', 'next', 'express')"
        },
        "provider": {
          "type": "string",
          "minLength": 1,
          "description": "Provider/library name (e.g., 'jwt', 'next-auth', 'passport')"
        },
        "config": {
          "type": "object",
          "additionalProperties": {},
          "description": "Capability-specific configuration options"
        },
        "endpoints": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "method": {
                "type": "string",
                "enum": ["GET", "POST", "PUT", "PATCH", "DELETE"]
              },
              "path": {
                "type": "string",
                "pattern": "^\\/"
              },
              "description": {
                "type": "string"
              },
              "group": {
                "type": "string",
                "description": "Route group name (supports wildcard '*' to match all endpoints in a group, e.g., '/api/v1/*')"
              }
            },
            "additionalProperties": false
          },
          "description": "Additional endpoints to create for this capability"
        }
      },
      "required": ["kind", "scope", "capability", "framework"],
      "additionalProperties": false
    }
  }
}
